# Настройка Volume на Railway для сохранения базы данных

## ⚠️ ВАЖНО: База данных НЕ ДОЛЖНА сбрасываться при деплоях!

### Проблема
По умолчанию Railway создает новый контейнер при каждом деплое, и файл `db/news.db` удаляется.
Это приводит к потере:
- Истории опубликованных новостей
- Статистики использования AI (токены, запросы, стоимость)
- Кэша пересказов

### Решение: Настройка Volume

1. **Откройте ваш проект на Railway**
   - https://railway.app/project/[ваш-проект]

2. **Добавьте Volume:**
   - Нажмите на сервис `topnews`
   - Перейдите в раздел **"Volumes"** (или **"Settings"** → **"Volumes"**)
   - Нажмите **"+ New Volume"**
   - Mount Path: `/persist`
   - Нажмите **"Add"**

3. **Установите переменную окружения:**
   - Перейдите в **"Variables"**
   - Добавьте: `DATABASE_PATH=/persist/news.db`
   - Сохраните

4. **Перезапустите сервис:**
   - Railway автоматически сделает redeploy
   - Или нажмите **"Restart"**

### Проверка
После настройки Volume:
1. Отправьте команду `/status` в бот - запишите значения
2. Сделайте деплой (git push)
3. Снова отправьте `/status` - данные должны остаться!

### Синхронизация с DeepSeek
После настройки Volume отправьте команду для одноразовой синхронизации:

```
/update_stats 1661 515627 0.06
```

Замените значения на актуальные из https://platform.deepseek.com/usage

### Как это работает
- **Без Volume:** `/app/db/news.db` - удаляется при каждом деплое
- **С Volume:** `/persist/news.db` - сохраняется навсегда

### Важно
- Volume настраивается **один раз**
- Данные сохраняются между деплоями
- Все пользователи видят одну общую статистику
- Токены учитываются автоматически и НЕ сбрасываются
