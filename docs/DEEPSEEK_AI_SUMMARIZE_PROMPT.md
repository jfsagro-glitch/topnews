# PROMPT –î–õ–Ø GITHUB COPILOT / CURSOR

## –ó–∞–¥–∞—á–∞: –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É AI Summarize —Å DeepSeek API

### –ö–æ–Ω—Ç–µ–∫—Å—Ç

Telegram-–±–æ—Ç TopNews –ø—É–±–ª–∏–∫—É–µ—Ç –Ω–æ–≤–æ—Å—Ç–∏ 3 —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å —Å –∫–Ω–æ–ø–∫–æ–π **"–ò–ò"** –¥–ª—è –ø–µ—Ä–µ—Å–∫–∞–∑–∞, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç:

1. –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –≤—ã–∑—ã–≤–∞—Ç—å DeepSeek API
2. –ü–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–µ—Å–∫–∞–∑ –Ω–æ–≤–æ—Å—Ç–∏ –ò–ò
3. –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –Ω–æ–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ —Å –∏—Å—Ö–æ–¥–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

#### 1. UI/UX

**–¢—Ä–µ–±—É–µ—Ç—Å—è:**
```
[–ò–ò]
```

- –û–¥–Ω–∞ –∫–Ω–æ–ø–∫–∞ (InlineKeyboardMarkup —Å 1 –∫–Ω–æ–ø–∫–æ–π)
- –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ "–ò–ò" ‚Üí –∑–∞–≥—Ä—É–∑–∫–∞ ‚Üí –ø–µ—Ä–µ—Å–∫–∞–∑ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏
- –ò—Å—Ö–æ–¥–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è, –ø–µ—Ä–µ—Å–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ

#### 2. Backend (DeepSeek API)

**API Endpoint:**
```
https://api.deepseek.com/chat/completions
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- Model: `deepseek-chat`
- API Key: `${DEEPSEEK_API_KEY}` (–∏–∑ .env)
- Max tokens: 500 (–¥–ª—è –∫–æ–º–ø–∞–∫—Ç–Ω–æ–≥–æ –ø–µ—Ä–µ—Å–∫–∞–∑–∞)
- Temperature: 0.7 (–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –º–µ–∂–¥—É —Ç–æ—á–Ω–æ—Å—Ç—å—é –∏ –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å—é)

**–ü—Ä–æ–º—Ç –¥–ª—è –ø–µ—Ä–µ—Å–∫–∞–∑–∞:**
```
–¢—ã - —Ä–µ–¥–∞–∫—Ç–æ—Ä –Ω–æ–≤–æ—Å—Ç–µ–π. –î–∞–π –∫—Ä–∞—Ç–∫–∏–π, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–π –ø–µ—Ä–µ—Å–∫–∞–∑ —ç—Ç–æ–π –Ω–æ–≤–æ—Å—Ç–∏ (200-300 —Å–ª–æ–≤). 
–°–æ—Ö—Ä–∞–Ω–∏ –≤—Å–µ –∫–ª—é—á–µ–≤—ã–µ —Ñ–∞–∫—Ç—ã, –Ω–æ –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π —Ç–∞–∫, —á—Ç–æ–±—ã –±—ã–ª–æ –ø–æ–Ω—è—Ç–Ω–æ –Ω–æ–≤–∏—á–∫—É.

–ò—Å—Ö–æ–¥–Ω–∞—è –Ω–æ–≤–æ—Å—Ç—å:
---
{title}

{text}
---

–ù–∞–ø–∏—à–∏ –ø–µ—Ä–µ—Å–∫–∞–∑ –±–µ–∑ –≤–≤–æ–¥–Ω—ã—Ö —Ñ—Ä–∞–∑ —Ç–∏–ø–∞ "–°–æ–≥–ª–∞—Å–Ω–æ –Ω–æ–≤–æ—Å—Ç–∏", –ø—Ä–æ—Å—Ç–æ —Ç–µ–∫—Å—Ç.
–î–æ–±–∞–≤—å –≤ –∫–æ–Ω–µ—Ü —Å—Ç—Ä–æ–∫—É: "–ò—Å—Ç–æ—á–Ω–∏–∫: {source}"
```

#### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- –ï—Å–ª–∏ DeepSeek –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ "API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
- –ï—Å–ª–∏ –Ω–æ–≤–æ—Å—Ç—å —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∞—è ‚Üí –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∑–∞–ø—Ä–æ—Å
- Timeout: 10 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∑–∞–ø—Ä–æ—Å

#### 4. Rate Limiting

- –ú–∞–∫—Å–∏–º—É–º 3 –∑–∞–ø—Ä–æ—Å–∞ –≤ –º–∏–Ω—É—Ç—É –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –Ω–∞ 1 —á–∞—Å (DB —Ç–∞–±–ª–∏—Ü–∞ `ai_summaries`)

#### 5. –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚úÖ **–†–ê–ó–†–ï–®–ï–ù–û:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ DeepSeek API –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–ø–µ—Ä–µ—Å–∫–∞–∑)
- –£–∫–∞–∑–∞–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- –ü–µ—Ä–µ—Å–∫–∞–∑ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–º—ã –∏–º–µ–µ–º –ª–∏—Ü–µ–Ω–∑–∏—é —á–µ—Ä–µ–∑ RSS/HTML)
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–≥–∞ –¥–ª—è –∞—É–¥–∏—Ç–∞

‚ùå **–ó–ê–ü–†–ï–©–ï–ù–û:**
- –£–¥–∞–ª—è—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –∏–ª–∏ —Å–∫—Ä—ã–≤–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫
- –ù–µ —É–∫–∞–∑—ã–≤–∞—Ç—å DeepSeek –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫ –ø–µ—Ä–µ—Å–∫–∞–∑–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –ø–µ—Ä–µ–µ–ø—É–±–ª–∏–∫–∞—Ü–∏–∏

#### 6. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```python
logger.info(f"AI Summarize requested for news_id={news_id}, user={user_id}")
logger.info(f"DeepSeek API response: {response_time}ms, tokens={tokens_used}")
logger.warning(f"AI Summarize failed: {error}, news_id={news_id}")
```

### –§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è

1. **bot.py:**
    - –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "–ò–ò" –≤ `_format_news_message()`
    - –û–±—Ä–∞–±–æ—Ç—á–∏–∫ callback'–∞ `on_ai_summarize_button_pressed()`
   - –§—É–Ω–∫—Ü–∏—è `_summarize_with_deepseek()`
   - Rate limiting (dict —Å timestamps)

2. **db/database.py:**
   - –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ `ai_summaries` (id, news_id, summary_text, created_at)
   - –ú–µ—Ç–æ–¥—ã `get_cached_summary()` –∏ `save_summary()`

3. **config/config.py:**
   - `DEEPSEEK_API_KEY` (–∏–∑ .env)
   - `DEEPSEEK_API_ENDPOINT = "https://api.deepseek.com/chat/completions"`
   - `AI_SUMMARY_TIMEOUT = 10`
   - `AI_SUMMARY_MAX_REQUESTS_PER_MINUTE = 3`

4. **requirements.txt:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ `httpx` (—É–∂–µ –µ—Å—Ç—å –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤)

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–¢–µ–∫—É—â–∏–π workflow:**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –Ω–æ–≤–æ—Å—Ç—å –≤ –∫–∞–Ω–∞–ª–µ:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ó–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–æ–≤–æ—Å—Ç–∏                   ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ –ü–µ—Ä–≤—ã–π –∞–±–∑–∞—Ü –Ω–æ–≤–æ—Å—Ç–∏...             ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ –ò—Å—Ç–æ—á–Ω–∏–∫: Lenta.ru                  ‚îÇ
‚îÇ https://lenta.ru/news/2026/01/01... ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ #–†–æ—Å—Å–∏—è                             ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ [–ò–ò]                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–ù–∞–∂–∏–º–∞–µ—Ç [–ò–ò] ‚Üí –≤ –õ–° –ø—Ä–∏—Ö–æ–¥–∏—Ç:

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ü§ñ –ü–µ—Ä–µ—Å–∫–∞–∑: –ó–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–æ–≤–æ—Å—Ç–∏     ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ [–ü–µ—Ä–µ—Å–∫–∞–∑ –ò–ò 200 —Å–ª–æ–≤...]           ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ –ò—Å—Ç–æ—á–Ω–∏–∫: Lenta.ru                  ‚îÇ
‚îÇ üîó –ò—Å—Ö–æ–¥–Ω–∞—è: https://lenta.ru/...   ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ ‚è±Ô∏è –ü–µ—Ä–µ—Å–∫–∞–∑–∞–Ω–æ –≤ 2.3 —Å–µ–∫            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ö–æ–¥-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤ bot.py:**
```python
class NewsBot:
    def __init__(self):
        # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥
        self.ai_rate_limit = {}  # {user_id: [timestamp1, timestamp2, ...]}
        self.deepseek_client = AsyncDeepSeekClient()
    
    async def _create_news_keyboard(self, news_id):
        """–°–æ–∑–¥–∞—Ç—å –∫–Ω–æ–ø–∫—É –ò–ò"""
        return InlineKeyboardMarkup([
            [
                InlineKeyboardButton("–ò–ò", callback_data=f"ai_{news_id}")
            ]
        ])
    
    async def on_ai_summarize_button(self, update, context):
        """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ AI"""
        news_id = extract_news_id(update.callback_query.data)
        user_id = update.effective_user.id
        
        # Rate limiting
        if self._check_rate_limit(user_id):
            await update.callback_query.answer("‚è±Ô∏è –°–ª–∏—à–∫–æ–º —á–∞—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã. –ü–æ–¥–æ–∂–¥–∏—Ç–µ...")
            return
        
        # –ó–∞–≥—Ä—É–∑–∫–∞
        await update.callback_query.answer("‚è≥ –°–æ–∑–¥–∞—é –ø–µ—Ä–µ—Å–∫–∞–∑...")
        
        # –ü–æ–ª—É—á–∏—Ç—å –Ω–æ–≤–æ—Å—Ç—å
        news = self.db.get_news_by_id(news_id)
        
        # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫—ç—à
        cached = self.db.get_cached_summary(news_id)
        if cached:
            summary = cached
        else:
            # –í—ã–∑–≤–∞—Ç—å DeepSeek
            summary = await self.deepseek_client.summarize(
                title=news['title'],
                text=news['text']
            )
            # –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å
            self.db.save_summary(news_id, summary)
        
        # –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        await context.bot.send_message(
            chat_id=user_id,
            text=f"ü§ñ –ü–µ—Ä–µ—Å–∫–∞–∑: {news['title']}\n\n{summary}\n\n–ò—Å—Ç–æ—á–Ω–∏–∫: {news['source']}",
            disable_web_page_preview=True
        )
```

### –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- **DeepSeek –≤—ã–±—Ä–∞–Ω –ø–æ—Ç–æ–º—É —á—Ç–æ:** –¥–µ—à–µ–≤–ª–µ Claude/GPT-4, —Ö–æ—Ä–æ—à–∏–π –∫–∞—á–µ—Å—Ç–≤–æ, –ø—Ä–æ—Å—Ç–æ–π API
- **Rate limiting:** –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞ –∏ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ (–±–µ—Ä—ë–º –¥–µ–Ω—å–≥–∏ –∑–∞ —Ç–æ–∫–µ–Ω—ã)
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** –æ–¥–Ω–∞ –∏ —Ç–∞ –∂–µ –Ω–æ–≤–æ—Å—Ç—å –Ω–µ –ø–µ—Ä–µ—Å–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–≤–∞–∂–¥—ã
- **–¢–∞–π–º–∞—É—Ç:** 10 —Å–µ–∫ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è DeepSeek (–æ–±—ã—á–Ω–æ 2-3 —Å–µ–∫)

### –î–æ–ø. –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–Æ—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** –ø–µ—Ä–µ—Å–∫–∞–∑ –ò–ò –Ω–µ –Ω–∞—Ä—É—à–∞–µ—Ç –∞–≤—Ç–æ—Ä—Å–∫–∏–µ –ø—Ä–∞–≤–∞ (—ç—Ç–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è, –∞ –Ω–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ)
2. **–ò—Å—Ö–æ–¥–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫:** –≤—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –∏—Å—Ö–æ–¥–Ω—É—é –Ω–æ–≤–æ—Å—Ç—å
3. **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å:** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç, —á—Ç–æ —ç—Ç–æ AI Summarize, –Ω–µ —Å–∫—Ä—ã—Ç–æ
4. **–ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞:** –ø–µ—Ä–≤—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–µ—Ä–µ—Å–∫–∞–∑–æ–≤ –≤—Ä—É—á–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

---

**–î–∞—Ç–∞:** 01 —Ñ–µ–≤—Ä–∞–ª—è 2026  
**–£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:** Medium (REST API + Telegram callbacks + DB)  
**–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 2-3 —á–∞—Å–∞
