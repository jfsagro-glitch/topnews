# üõ† –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Sandbox –ë–æ—Ç–∞

## –û–±–∑–æ—Ä

Sandbox-–≤–µ—Ä—Å–∏—è –±–æ—Ç–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∞ –≤ **–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** —Å –µ–¥–∏–Ω—ã–º –≥–ª–æ–±–∞–ª—å–Ω—ã–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º —Å–∏—Å—Ç–µ–º–æ–π. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º —É–ø—Ä–∞–≤–ª—è—Ç—å –≤—Å–µ–º–∏ –∞—Å–ø–µ–∫—Ç–∞–º–∏ —Ä–∞–±–æ—Ç—ã –æ–±–æ–∏—Ö –±–æ—Ç–æ–≤ (prod –∏ sandbox) –∏–∑ –µ–¥–∏–Ω–æ–≥–æ –º–µ—Å—Ç–∞.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **Global Stop Services** (`core/services/global_stop.py`)
   - Redis-based –≥–ª–æ–±–∞–ª—å–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã
   - SQLite fallback –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Redis
   - –ï–¥–∏–Ω—ã–π –∫–ª—é—á: `system:global_stop` (–∑–Ω–∞—á–µ–Ω–∏–µ: "0" –∏–ª–∏ "1")
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö —Å–±–æ—Ä–∞ –Ω–æ–≤–æ—Å—Ç–µ–π

2. **Sandbox Admin UI**
   - –î–æ—Å—Ç—É–ø–Ω–∞ –¢–û–õ–¨–ö–û –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
   - –ê–¥–º–∏–Ω-–º–µ–Ω—é –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É –≤ `/start`
   - –ë–µ–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–Ω–æ–ø–æ–∫ (–ø–∞—É–∑–∞/—Ä–µ–∑—é–º–µ/–æ—Ç–ø—Ä–∞–≤–∏—Ç—å)
   - 6 –æ—Å–Ω–æ–≤–Ω—ã—Ö –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–µ–π + –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

3. **Integration Points**
   - `run_periodic_collection()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ global_stop –ø–µ—Ä–µ–¥ —Å–±–æ—Ä–æ–º
   - `collect_and_publish()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ global_stop –ø–µ—Ä–µ–¥ –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π
   - Graceful degradation: –µ—Å–ª–∏ system_stop=1, –∫–æ–ª–ª–µ–∫—Ç–æ—Ä —Å–ø–∏—Ç 5 —Å–µ–∫ –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–æ–π

### –û—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

–î–æ—Å—Ç—É–ø–Ω–æ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É `/start` (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤).

–û—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é —Å–æ–¥–µ—Ä–∂–∏—Ç 7 —Ä–∞–∑–¥–µ–ª–æ–≤:

```
üõ† –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–æ–º

–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª:
‚îå‚îÄ ‚õî –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å/–≤–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å –≤—Å—é —Å–∏—Å—Ç–µ–º—É
‚îú‚îÄ üìä –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
‚îú‚îÄ ü§ñ AI —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
‚îú‚îÄ üì∞ –ò—Å—Ç–æ—á–Ω–∏–∫–∏
‚îú‚îÄ üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
‚îú‚îÄ ‚öô –ù–∞—Å—Ç—Ä–æ–π–∫–∏
‚îú‚îÄ üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∏–Ω–≤–∞–π—Ç—ã
‚îî‚îÄ üß∞ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
```

---

## üìä –ü–∞–Ω–µ–ª—å 1: –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã:
- ü§ñ **–û–∫—Ä—É–∂–µ–Ω–∏–µ**: prod –∏–ª–∏ sandbox
- ‚èπ **–ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞**: —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–û–°–¢–ê–ù–û–í–õ–ï–ù–ê –∏–ª–∏ –ó–ê–ü–£–©–ï–ù–ê)
- üî¥ **Redis —Å—Ç–∞—Ç—É—Å**: ‚úÖ OK –∏–ª–∏ ‚ö†Ô∏è Fallback (SQLite)
- üóÑÔ∏è **–ë–î**: SQLite (news.db)

### –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏—è

- **‚õî –û–°–¢–ê–ù–û–í–ò–¢–¨ –í–°–Æ –°–ò–°–¢–ï–ú–£** (–µ—Å–ª–∏ —Å–∏—Å—Ç–µ–º–∞ –∑–∞–ø—É—â–µ–Ω–∞) / **‚úÖ –í–û–ó–û–ë–ù–û–í–ò–¢–¨ –í–°–Æ –°–ò–°–¢–ï–ú–£** (–µ—Å–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞)
  - –¢–æ–≥–≥–ª–∏—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Ñ–ª–∞–≥ `system:global_stop`
  - –í–ª–∏—è–µ—Ç –Ω–∞ –û–ë–ê –±–æ—Ç–∞ (prod –∏ sandbox)
   - –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è: `[ADMIN] SYSTEM FULL STOP/RESUME by admin_id=Y`

- **‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é** - –≤–æ–∑–≤—Ä–∞—Ç –≤ –æ—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é

### –ü–æ–≤–µ–¥–µ–Ω–∏–µ

**–ö–æ–≥–¥–∞ system_stop = 1:**
- Production bot –ù–ï —Å–æ–±–∏—Ä–∞–µ—Ç –Ω–æ–≤–æ—Å—Ç–∏ –∏ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∫—Ä–æ–º–µ —Å–ª—É–∂–µ–±–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
- Sandbox bot –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å "üî¥ –°–∏—Å—Ç–µ–º–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞" –≤ –æ—Ç–≤–µ—Ç–∞—Ö
- Collection loop —Å–ø–∏—Ç 5 —Å–µ–∫ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π

**–ö–æ–≥–¥–∞ system_stop = 0:**
- –û–±–∞ –±–æ—Ç–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ
- –°–±–æ—Ä –Ω–æ–≤–æ—Å—Ç–µ–π –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è

---

## ü§ñ –ü–∞–Ω–µ–ª—å 2: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ AI

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ AI –º–æ–¥—É–ª—è–º–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–º–∏ —Å–∏—Å—Ç–µ–º–æ–π.

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–æ–¥—É–ª–∏

1. **Hashtags** üè∑Ô∏è - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ö–µ—àTag–æ–≤
2. **Cleanup** üßπ - –æ—á–∏—Å—Ç–∫–∞ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
3. **Summary** üìù - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∑—é–º–µ –Ω–æ–≤–æ—Å—Ç–µ–π

### –£—Ä–æ–≤–Ω–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

- **0** = –æ—Ç–∫–ª—é—á–µ–Ω–æ (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- **1-4** = —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å—Ç–µ–ø–µ–Ω–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- **5** = –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

### –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å

```
ü§ñ –£–ü–†–ê–í–õ–ï–ù–ò–ï AI –ú–û–î–£–õ–Ø–ú–ò

–í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥—É–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
‚îå‚îÄ üè∑Ô∏è Hashtags
‚îú‚îÄ üßπ Cleanup
‚îú‚îÄ üìù Summary
‚îî‚îÄ ‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é
```

–ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –º–æ–¥—É–ª—è:

```
ü§ñ –ú–û–î–£–õ–¨: HASHTAGS

–¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å: 2 –∏–∑ 5
0 = –æ—Ç–∫–ª—é—á–µ–Ω–æ
5 = –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π

–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å:
‚îå‚îÄ [0] [1] [2] [3]
‚îú‚îÄ [4] [5]
‚îî‚îÄ ‚¨ÖÔ∏è –ù–∞–∑–∞–¥
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ö–∞–∂–¥–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è:
```
Log: "AI module {module} changed to level {new_level} by admin_id={admin_id}"
```

---

## üì∞ –ü–∞–Ω–µ–ª—å 3: –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –Ω–æ–≤–æ—Å—Ç–µ–π.

### –ü–æ–∫–∞–∑—ã–≤–∞–µ–º–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- –ê–∫—Ç–∏–≤–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∫–ª—é—á–µ–Ω–Ω—ã—Ö
- –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
- –û—à–∏–±–æ–∫: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –ø—Ä–∏ —Å–±–æ—Ä–µ

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

- **‚úÖ –í–∫–ª—é—á–∏—Ç—å –≤—Å–µ** / **‚ùå –û—Ç–∫–ª—é—á–∏—Ç—å –≤—Å–µ**
  - –¢–æ–≥–≥–ª–∏—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤—Å–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
  - –í–ª–∏—è–µ—Ç –Ω–∞ —Å–±–æ—Ä –Ω–æ–≤–æ—Å—Ç–µ–π

- **üîç –ü–µ—Ä–µ–æ—Ü–µ–Ω–∏—Ç—å —Å–µ–π—á–∞—Å**
  - –ó–∞–ø—É—Å–∫–∞–µ—Ç –ø–µ—Ä–µ–æ—Ü–µ–Ω–∫—É –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
  - –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ "Sources rescan requested by admin_id=X"

- **‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é**

### –ü–æ–≤–µ–¥–µ–Ω–∏–µ

- –ö–æ–≥–¥–∞ –≤—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –æ—Ç–∫–ª—é—á–µ–Ω—ã - –Ω–æ–≤–æ—Å—Ç–∏ –Ω–µ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è
- –ü—Ä–∏ –ø–µ—Ä–µ–æ—Ü–µ–Ω–∫–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è health-check –∫–∞–∂–¥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–µ—à–∏—Ä—É—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ

---

## üìà –ü–∞–Ω–µ–ª—å 4: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –ü–æ–∫–∞–∑—ã–≤–∞–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏

- üìä **–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ (24—á)**: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤–æ—Å—Ç–µ–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞
- ü§ñ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ AI**: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ DeepSeek API
- üí∞ **–†–∞—Å—Ö–æ–¥—ã AI**: —Å—Ç–æ–∏–º–æ—Å—Ç—å AI –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ USD
- ‚ö†Ô∏è **–û—à–∏–±–æ–∫/–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π**: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
- üì∞ **–¢–æ–ø –∏—Å—Ç–æ—á–Ω–∏–∫**: –∏—Å—Ç–æ—á–Ω–∏–∫ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –Ω–æ–≤–æ—Å—Ç–µ–π

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

- –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- –ö–Ω–æ–ø–∫–∞ **üîÑ –û–±–Ω–æ–≤–∏—Ç—å** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
üìà –°–¢–ê–¢–ò–°–¢–ò–ö–ê

üìä –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ (24—á): 127 –Ω–æ–≤–æ—Å—Ç–µ–π
ü§ñ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ AI: 1,234 –∑–∞–ø—Ä–æ—Å–æ–≤
üí∞ –†–∞—Å—Ö–æ–¥—ã AI: $0.18
‚ö† –û—à–∏–±–æ–∫/–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π: 3
üì∞ –¢–æ–ø –∏—Å—Ç–æ—á–Ω–∏–∫: interfax.ru

–û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç.

[üîÑ –û–±–Ω–æ–≤–∏—Ç—å]
[‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é]
```

---

## ‚öô –ü–∞–Ω–µ–ª—å 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∏

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

#### 1. ‚è±Ô∏è –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏

–ö–∞–∫ —á–∞—Å—Ç–æ –∫–æ–ª–ª–µ–∫—Ç–æ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∏:

- **60 —Å–µ–∫** - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —á–∞—Å—Ç—ã–π —Å–±–æ—Ä (drain, –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤ prod)
- **120 —Å–µ–∫** - —á–∞—Å—Ç—ã–π (—Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è development)
- **300 —Å–µ–∫** - —Å—Ä–µ–¥–Ω–∏–π (—Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è prod, ***—Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ***)
- **600 —Å–µ–∫** - —Ä–µ–¥–∫–∏–π —Å–±–æ—Ä
- **1200 —Å–µ–∫** - –æ—á–µ–Ω—å —Ä–µ–¥–∫–∏–π (2 –º–∏–Ω—É—Ç—ã –º–µ–∂–¥—É —Å–±–æ—Ä–∫–∞–º–∏)

**–¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**: 300—Å (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è Railway cost reduction)

#### 2. üîÑ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏

–°–∫–æ–ª—å–∫–æ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ:

- **1** - –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ (–º–µ–¥–ª–µ–Ω–Ω–æ, –º–∞–ª–æ —Ä–µ—Å—É—Ä—Å–æ–≤)
- **2** - –æ—á–µ–Ω—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ
- **3** - —Å—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å (***—Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ***, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ)
- **5** - –≤—ã—Å–æ–∫–∏–π –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º
- **10** - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π (—Ç—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ –ø–∞–º—è—Ç–∏)

**–¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**: 3 (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è Railway cost reduction)

#### 3. üìù –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

–ö–∞–∫ –¥–µ—Ç–∞–ª—å–Ω–æ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å–æ–±—ã—Ç–∏—è:

- **DEBUG** - –≤—Å–µ —Å–æ–±—ã—Ç–∏—è (–º–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞, –º–µ–¥–ª–µ–Ω–Ω–µ–µ)
- **INFO** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (***—Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ***)
- **WARNING** - —Ç–æ–ª—å–∫–æ –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
- **ERROR** - —Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏

### –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å

```
‚öô –ù–ê–°–¢–†–û–ô–ö–ò –°–ò–°–¢–ï–ú–´

‚è±Ô∏è –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏: 300—Å
üîÑ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏: 3
üìù –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è: INFO

–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:

[‚è±Ô∏è –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏]
[üîÑ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç—å]
[üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ]
[‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é]
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ö–∞–∂–¥–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è:
```
Log: "CHECK_INTERVAL changed to {interval}s by admin_id={admin_id}"
Log: "Parallel tasks changed to {count} by admin_id={admin_id}"
Log: "Log level changed to {level} by admin_id={admin_id}"
```

---

## üë• –ü–∞–Ω–µ–ª—å 6: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∏–Ω–≤–∞–π—Ç—ã

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫ –±–æ—Ç—É.

### –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–û–¥–æ–±—Ä–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏**:
- –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–æ—Ñ–∏–ª—è
- –ö–Ω–æ–ø–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: ID, username, –¥–∞—Ç–∞ –æ–¥–æ–±—Ä–µ–Ω–∏—è, –∏–Ω–≤–∞–π—Ç-–∫–æ–¥

**–ê–∫—Ç–∏–≤–Ω—ã–µ –∏–Ω–≤–∞–π—Ç—ã**:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –∏–Ω–≤–∞–π—Ç–æ–≤
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –∏–Ω–≤–∞–π—Ç–æ–≤
- –û—Ç–ø—Ä–∞–≤–∫–∞ –∏–Ω–≤–∞–π—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

- **‚ûï –°–æ–∑–¥–∞—Ç—å –∏–Ω–≤–∞–π—Ç** - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π –∏–Ω–≤–∞–π—Ç-–∫–æ–¥
- **üëÅÔ∏è –°–ø–∏—Å–æ–∫** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ—Ö –æ–¥–æ–±—Ä–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **üîí –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å** - –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∏–Ω–≤–∞–π—Ç–∞–º–∏

‚úÖ –û–¥–æ–±—Ä–µ–Ω–Ω—ã–µ: 12 —á–µ–ª.
üì® –ê–∫—Ç–∏–≤–Ω—ã–µ –∏–Ω–≤–∞–π—Ç—ã: 3

[‚ûï –°–æ–∑–¥–∞—Ç—å –∏–Ω–≤–∞–π—Ç]
[üëÅÔ∏è –°–ø–∏—Å–æ–∫]
[‚¨ÖÔ∏è –ù–∞–∑–∞–¥]
```

---

## –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

–í—Å–µ –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º:

```python
is_admin = self._is_admin(user_id)
if not is_admin:
    await query.answer("‚ùå –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω", show_alert=True)
    return
```

### –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã

–û–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
- `ADMIN_IDS` - —Å—Ç—Ä–æ–∫–∞ —Å ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (–≤ prod –±–æ—Ç–µ)
- `ADMIN_IDS_SANDBOX` - –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã sandbox –≤–µ—Ä—Å–∏–∏

### –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –¥–æ—Å—Ç—É–ø–∞

```
‚ùå –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω
```

---

## –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å Global Stop

### –ú–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–±–æ—Ç—ã

#### Redis (primary)

1. **Storage**: –∫–ª—é—á `system:global_stop`
2. **–∑–Ω–∞—á–µ–Ω–∏–µ**: `"0"` (–∑–∞–ø—É—â–µ–Ω–∞) –∏–ª–∏ `"1"` (–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞)
3. **TTL**: –Ω–µ—Ç (–ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
4. **timeout**: 2 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ connection

#### SQLite fallback

1. **Table**: `system_settings`
2. **Columns**: `key`, `value`, `updated_at`
3. **Fallback**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –µ—Å–ª–∏ Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
4. **—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

```python
from core.services.global_stop import get_global_stop_status_str

is_stopped, status_string = get_global_stop_status_str()
# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# is_stopped = True/False
# status_string = "üî¥ –û–°–¢–ê–ù–û–í–õ–ï–ù–ê" / "üü¢ –ó–ê–ü–£–©–ï–ù–ê"
```

### –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ

```python
from core.services.global_stop import toggle_global_stop

new_state = toggle_global_stop()
# –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: True = –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞, False = –∑–∞–ø—É—â–µ–Ω–∞
```

---

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

### –°–æ–±—ã—Ç–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏—Ö –º–µ—Å—Ç–∞—Ö

1. **–ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞**:
   ```
   [ADMIN] GLOBAL_STOP set to 1 by admin_id=123456789
   [ADMIN] GLOBAL_STOP set to 0 by admin_id=123456789
   ```

2. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ AI –º–æ–¥—É–ª–µ–π**:
   ```
   [ADMIN] AI module hashtags level changed to 3 by admin_id=123456789
   ```

3. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏**:
   ```
   [ADMIN] Sources rescan requested by admin_id=123456789
   [ADMIN] Sources toggle_all by admin_id=123456789
   ```

4. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã**:
   ```
   [ADMIN] CHECK_INTERVAL changed to 600s by admin_id=123456789
   [ADMIN] Parallel tasks changed to 5 by admin_id=123456789
   [ADMIN] Log level changed to ERROR by admin_id=123456789
   ```

---

## –ü–æ–≤–µ–¥–µ–Ω–∏–µ –≤–æ –≤—Ä–µ–º—è system_stop

### Production Bot

–ö–æ–≥–¥–∞ `system:global_stop = "1"`:

1. **Collection loop** - —Å–ø–∏—Ç, –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç –Ω–æ–≤–æ—Å—Ç–∏
2. **User commands** - –æ—Ç–≤–µ—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å–ª—É–∂–µ–±–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
3. **Inline buttons** - –æ—Ç–∫–ª—é—á–µ–Ω—ã
4. **Message**: `üî¥ –°–∏—Å—Ç–µ–º–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.`

### Sandbox Admin Bot

–ö–æ–≥–¥–∞ `system:global_stop = "1"`:

1. **Admin panels** - –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
2. **Status page** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "üî¥ –û–°–¢–ê–ù–û–í–õ–ï–ù–ê"
3. **Collections** - –æ—Ç–∫–ª—é—á–µ–Ω—ã (–ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤ run_periodic_collection)
4. **Admin –º–æ–∂–µ—Ç –≤–∫–ª—é—á–∏—Ç—å —Å–∏—Å—Ç–µ–º—É** –æ–±—Ä–∞—Ç–Ω–æ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É

### Graceful degradation

- –ï—Å–ª–∏ Redis –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SQLite fallback
- –ï—Å–ª–∏ SQLite –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí —Å–∏—Å—Ç–µ–º–∞ —Å—á–∏—Ç–∞–µ—Ç global_stop = 0 (–∑–∞–ø—É—â–µ–Ω–∞)
- –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è: `"WARNING: Redis unavailable, using SQLite fallback for system:global_stop"`

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è

```
1. Admin –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç /start
2. –ù–∞–∂–∏–º–∞–µ—Ç "üõ† –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ"
3. –í—ã–±–∏—Ä–∞–µ—Ç "üìä –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã"
4. –ù–∞–∂–∏–º–∞–µ—Ç "üî¥ –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å"
5. ‚úÖ –°–∏—Å—Ç–µ–º–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
6. –í—Å–µ –±–æ—Ç—ã –ø—Ä–µ–∫—Ä–∞—â–∞—é—Ç —Å–±–æ—Ä –Ω–æ–≤–æ—Å—Ç–µ–π
7. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—Å—Ç–∞–Ω–æ–≤–∫–µ
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ —Å–±–æ—Ä–∞

```
1. Admin: "üìä –°—Ç–∞—Ç—É—Å" ‚Üí "‚öô –ù–∞—Å—Ç—Ä–æ–π–∫–∏" ‚Üí "‚è±Ô∏è –ò–Ω—Ç–µ—Ä–≤–∞–ª"
2. –í—ã–±–∏—Ä–∞–µ—Ç "600s" (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç –≤–º–µ—Å—Ç–æ 5)
3. ‚úÖ –ò–Ω—Ç–µ—Ä–≤–∞–ª —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ 600—Å
4. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –û—Ç–∫–ª—é—á–µ–Ω–∏–µ AI Cleanup

```
1. Admin: "ü§ñ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ AI" ‚Üí "üßπ Cleanup"
2. –ù–∞–∂–∏–º–∞–µ—Ç [0] (–æ—Ç–∫–ª—é—á–∏—Ç—å)
3. ‚úÖ Cleanup: —É—Ä–æ–≤–µ–Ω—å 0
4. –ù–æ–≤—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –Ω–µ –ø—Ä–æ—Ö–æ–¥—è—Ç cleanup —Ñ–∏–ª—å—Ç—Ä
```

---

## –§–∏—á–∏ –≤ –ø–ª–∞–Ω–µ

- [ ] Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- [ ] –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –ø–µ—Ä–µ–æ—Ü–µ–Ω–∫–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- [ ] –ò–º–ø–æ—Ä—Ç/—ç–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- [ ] Scheduler –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –¥—Ä—É–≥–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π
- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- [ ] –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ú–µ—Ä—ã –∑–∞—â–∏—Ç—ã

1. **Admin ID verification** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å
2. **Logging** - –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
3. **Read-only fallback** - SQLite –Ω–µ –∏–º–µ–µ—Ç TTL, –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
4. **Timeout protection** - Redis timeout 2 —Å–µ–∫, –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç —Å–∏—Å—Ç–µ–º—É

### –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å

- Admin ID –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –¥–ª—è –∞—É–¥–∏—Ç–∞
- –ò–Ω–≤–∞–π—Ç-–∫–æ–¥—ã –ø–æ–¥–ø–∏—Å–∞–Ω—ã (HMAC-SHA256)
- –ü–∞—Ä–æ–ª–∏ –∏ —Ç–æ–∫–µ–Ω—ã –ù–ï –ª–æ–≥–∏—Ä—É—é—Ç—Å—è

---

## –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### Redis –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω

**–ü—Ä–æ–±–ª–µ–º–∞**: Redis connection timeout

**–†–µ—à–µ–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback –Ω–∞ SQLite. –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–µ–±–æ–ª—å—à–∏–º —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º latency.

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Redis status –Ω–∞ "üìä –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã" ‚Üí `üî¥ Redis —Å—Ç–∞—Ç—É—Å: ‚ö†Ô∏è Fallback (SQLite)`

### Amministrator –Ω–µ –≤–∏–¥–∏—Ç –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ü—Ä–æ–±–ª–µ–º–∞**: –ö–Ω–æ–ø–∫–∞ "üõ† –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ" –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∞–¥–º–∏–Ω-ID –≤ `ADMIN_IDS` –∏–ª–∏ `ADMIN_IDS_SANDBOX`

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**: 
```
/start ‚Üí –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫–Ω–æ–ø–∫–∞ "üõ† –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ" –≤ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ
```

### –°–∏—Å—Ç–µ–º–∞ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω—É—é –æ—Å—Ç–∞–Ω–æ–≤–∫—É

**–ü—Ä–æ–±–ª–µ–º–∞**: –ë–æ—Ç –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Å–æ–±–∏—Ä–∞—Ç—å –Ω–æ–≤–æ—Å—Ç–∏ –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ system_stop=1

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ global_stop –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤ `run_periodic_collection()` –∏ `collect_and_publish()`

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**:
```
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: 
[2024-01-01 12:00:00] Global stop is ON, sleeping 5s
```

---

## –ö–æ–º–∞–Ω–¥–Ω–∞—è —Å–ø—Ä–∞–≤–∫–∞

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

| –ö–æ–º–∞–Ω–¥–∞ | –î–µ–π—Å—Ç–≤–∏–µ |
|---------|----------|
| `/start` | –ü–æ–∫–∞–∑–∞—Ç—å –º–µ–Ω—é + —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ |
| `üõ† –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ` | –û—Ç–∫—Ä—ã—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å |
| `üìä –°—Ç–∞—Ç—É—Å` | –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã |
| `ü§ñ AI` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ AI –º–æ–¥—É–ª—è–º–∏ |
| `üì∞ –ò—Å—Ç–æ—á–Ω–∏–∫–∏` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ |
| `üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞` | –ü–æ–∫–∞–∑–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ |
| `‚öô –ù–∞—Å—Ç—Ä–æ–π–∫–∏` | –ò–∑–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é |
| `üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º |

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**: 1.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2024-01-01  
**–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: TopNews v2.0+
